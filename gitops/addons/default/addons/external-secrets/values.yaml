# External Secrets HA Configuration
replicaCount: 2

nodeSelector:
  karpenter.sh/nodepool: system

tolerations:
- key: "CriticalAddonsOnly"
  operator: "Exists"
  effect: "NoSchedule"

topologySpreadConstraints:
- maxSkew: 1
  topologyKey: topology.kubernetes.io/zone
  whenUnsatisfiable: DoNotSchedule
  labelSelector:
    matchLabels:
      app.kubernetes.io/name: external-secrets

podDisruptionBudget:
  enabled: true
  maxUnavailable: 1

# Cert Controller HA
certController:
  replicaCount: 2
  nodeSelector:
    karpenter.sh/nodepool: system
  tolerations:
  - key: "CriticalAddonsOnly"
    operator: "Exists"
    effect: "NoSchedule"
  topologySpreadConstraints:
  - maxSkew: 1
    topologyKey: topology.kubernetes.io/zone
    whenUnsatisfiable: DoNotSchedule
    labelSelector:
      matchLabels:
        app.kubernetes.io/name: external-secrets-cert-controller
  podDisruptionBudget:
    enabled: true
    maxUnavailable: 1

# Webhook HA
webhook:
  replicaCount: 2
  nodeSelector:
    karpenter.sh/nodepool: system
  tolerations:
  - key: "CriticalAddonsOnly"
    operator: "Exists"
    effect: "NoSchedule"
  topologySpreadConstraints:
  - maxSkew: 1
    topologyKey: topology.kubernetes.io/zone
    whenUnsatisfiable: DoNotSchedule
    labelSelector:
      matchLabels:
        app.kubernetes.io/name: external-secrets-webhook
  podDisruptionBudget:
    enabled: true
    maxUnavailable: 1
