apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: grafana-workload-dashboards
  namespace: argocd
spec:
  project: default
  source:
    repoURL: ${GITHUB_URL}
    targetRevision: ${GITHUB_BRANCH}
    path: "packages/grafana/manifests/"
    kustomize:
      patches:
        - target:
            kind: ConfigMap
            name: grafana-mysql-endpoint
          patch: |-
            - op: replace
              path: /data/MYSQL_ENDPOINT
              value: ${DEVLAKE_MYSQL_NODEPORT}
  destination:
    name: 'dev-cluster'
    namespace: grafana-operator
  syncPolicy:
    automated:
      selfHeal: true
    syncOptions: []
